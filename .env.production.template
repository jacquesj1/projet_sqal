# ==============================================================================
# Production Environment Variables - Syst√®me Gaveurs V3.0
# ==============================================================================
# Copy this file to .env.production and fill in the values
# DO NOT commit .env.production to version control
#
# Usage:
#   cp .env.production.template .env.production
#   # Edit .env.production with your values
#   docker-compose -f docker-compose.prod.yml --env-file .env.production up -d
# ==============================================================================

# ==============================================================================
# Build Information
# ==============================================================================
BUILD_DATE=2024-01-01T00:00:00Z
VERSION=3.0.0

# ==============================================================================
# Database Configuration (TimescaleDB)
# ==============================================================================
DATABASE_HOST=timescaledb
DATABASE_PORT=5432
DATABASE_NAME=gaveurs_db
DATABASE_USER=gaveurs_admin

# CRITICAL: Change this password!
DATABASE_PASSWORD=CHANGE_ME_STRONG_PASSWORD_HERE

# Database connection pool
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=40

# ==============================================================================
# Redis Configuration
# ==============================================================================
REDIS_HOST=redis
REDIS_PORT=6379

# CRITICAL: Set a strong Redis password
REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD

# ==============================================================================
# Application Security
# ==============================================================================
# CRITICAL: Generate strong random keys
# Use: openssl rand -hex 32
SECRET_KEY=CHANGE_ME_SECRET_KEY_64_CHARACTERS_MINIMUM_USE_OPENSSL_RAND
JWT_SECRET_KEY=CHANGE_ME_JWT_SECRET_KEY_64_CHARACTERS_MINIMUM

# JWT Configuration
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# ==============================================================================
# CORS Configuration
# ==============================================================================
# Comma-separated list of allowed origins
# Production example: https://euralis.example.com,https://gaveurs.example.com,https://sqal.example.com
CORS_ORIGINS=https://your-domain.com,https://euralis.your-domain.com,https://gaveurs.your-domain.com,https://sqal.your-domain.com

# ==============================================================================
# Frontend URLs
# ==============================================================================
# Public API URL (accessible from browsers)
NEXT_PUBLIC_API_URL=https://api.your-domain.com
VITE_API_URL=https://api.your-domain.com

# WebSocket URL
VITE_WS_URL=wss://api.your-domain.com

# ==============================================================================
# Domain Configuration
# ==============================================================================
# Main domain for SSL certificates
DOMAIN=your-domain.com

# Subdomains
API_DOMAIN=api.your-domain.com
EURALIS_DOMAIN=euralis.your-domain.com
GAVEURS_DOMAIN=gaveurs.your-domain.com
SQAL_DOMAIN=sqal.your-domain.com
MONITORING_DOMAIN=monitoring.your-domain.com

# ==============================================================================
# SSL/TLS Configuration
# ==============================================================================
# Email for Let's Encrypt notifications
LETSENCRYPT_EMAIL=admin@your-domain.com

# SSL certificate renewal staging mode (set to 1 for testing)
LETSENCRYPT_STAGING=0

# ==============================================================================
# Application Configuration
# ==============================================================================
APP_ENV=production
LOG_LEVEL=info
DEBUG=false

# Enable/disable features
ENABLE_METRICS=true
ENABLE_TRACING=false

# ==============================================================================
# Gunicorn Configuration
# ==============================================================================
# Number of worker processes (2-4 x number of CPU cores)
GUNICORN_WORKERS=4
GUNICORN_TIMEOUT=120
GUNICORN_KEEPALIVE=5

# ==============================================================================
# Monitoring Configuration
# ==============================================================================
# Grafana
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=CHANGE_ME_GRAFANA_PASSWORD
GRAFANA_SECRET_KEY=CHANGE_ME_GRAFANA_SECRET_KEY
GRAFANA_ROOT_URL=https://monitoring.your-domain.com
GRAFANA_DOMAIN=monitoring.your-domain.com

# Grafana Database (separate from main DB)
GRAFANA_DB_NAME=grafana
GRAFANA_DB_USER=grafana
GRAFANA_DB_PASSWORD=CHANGE_ME_GRAFANA_DB_PASSWORD

# Prometheus
PROMETHEUS_RETENTION_TIME=30d
PROMETHEUS_RETENTION_SIZE=10GB

# AlertManager
ALERTMANAGER_SLACK_WEBHOOK=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
ALERTMANAGER_EMAIL_FROM=alerts@your-domain.com
ALERTMANAGER_EMAIL_TO=ops@your-domain.com
ALERTMANAGER_SMTP_HOST=smtp.your-domain.com
ALERTMANAGER_SMTP_PORT=587
ALERTMANAGER_SMTP_USERNAME=alerts@your-domain.com
ALERTMANAGER_SMTP_PASSWORD=CHANGE_ME_SMTP_PASSWORD

# ==============================================================================
# SQAL Simulator Configuration
# ==============================================================================
SQAL_DEVICE_ID=ESP32_PROD_01
SQAL_INTERVAL=30

# ==============================================================================
# Storage Paths
# ==============================================================================
# Base path for persistent data
DATA_PATH=/opt/gaveurs/data

# Individual paths (will be created under DATA_PATH)
# Timescale data: ${DATA_PATH}/timescaledb
# Backups: ${DATA_PATH}/backups
# Logs: ${DATA_PATH}/logs/{backend,nginx}

# ==============================================================================
# Backup Configuration
# ==============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # 2 AM daily
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=gaveurs-backups
BACKUP_S3_REGION=eu-west-1
BACKUP_S3_ACCESS_KEY=CHANGE_ME_S3_ACCESS_KEY
BACKUP_S3_SECRET_KEY=CHANGE_ME_S3_SECRET_KEY

# ==============================================================================
# Email Configuration (for notifications)
# ==============================================================================
SMTP_HOST=smtp.your-domain.com
SMTP_PORT=587
SMTP_USERNAME=noreply@your-domain.com
SMTP_PASSWORD=CHANGE_ME_SMTP_PASSWORD
SMTP_FROM=noreply@your-domain.com
SMTP_TLS=true

# ==============================================================================
# External Services
# ==============================================================================
# Blockchain (Hyperledger Fabric)
BLOCKCHAIN_ENABLED=false
BLOCKCHAIN_CHANNEL=gaveurs-channel
BLOCKCHAIN_CHAINCODE=traceability
BLOCKCHAIN_PEER_URL=peer0.org1.example.com:7051
BLOCKCHAIN_ORDERER_URL=orderer.example.com:7050

# S3-compatible storage (for file uploads)
S3_ENABLED=false
S3_ENDPOINT=https://s3.eu-west-1.amazonaws.com
S3_BUCKET=gaveurs-uploads
S3_ACCESS_KEY=CHANGE_ME_S3_ACCESS_KEY
S3_SECRET_KEY=CHANGE_ME_S3_SECRET_KEY
S3_REGION=eu-west-1

# ==============================================================================
# Rate Limiting
# ==============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_BURST=100

# ==============================================================================
# Session Configuration
# ==============================================================================
SESSION_TIMEOUT_MINUTES=60
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=lax

# ==============================================================================
# File Upload Limits
# ==============================================================================
MAX_UPLOAD_SIZE_MB=10
ALLOWED_UPLOAD_TYPES=image/jpeg,image/png,application/pdf

# ==============================================================================
# Feature Flags
# ==============================================================================
FEATURE_CONSUMER_FEEDBACK=true
FEATURE_BLOCKCHAIN_TRACEABILITY=true
FEATURE_ML_PREDICTIONS=true
FEATURE_REALTIME_SENSORS=true
FEATURE_MULTI_SITE_SUPERVISION=true

# ==============================================================================
# Notes
# ==============================================================================
# 1. All passwords and secrets MUST be changed from defaults
# 2. Use strong, randomly generated passwords (minimum 32 characters)
# 3. Store sensitive values in a secure vault (e.g., HashiCorp Vault, AWS Secrets Manager)
# 4. Rotate secrets regularly (every 90 days)
# 5. Never commit .env.production to version control
# 6. Backup this file securely
# 7. Test configuration in staging environment before production deployment
