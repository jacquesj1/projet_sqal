# ==============================================================================
# Euralis Gaveurs System - Backup Configuration
# ==============================================================================
# Copy this file to backup-config.env and customize for your environment
# WARNING: This file contains sensitive credentials - DO NOT commit to git!
# ==============================================================================

# ==============================================================================
# DATABASE CONFIGURATION
# ==============================================================================
# TimescaleDB connection parameters
DB_HOST=localhost
DB_PORT=5432
DB_NAME=gaveurs_db
DB_USER=gaveurs_admin
DB_PASSWORD=gaveurs_secure_2024

# ==============================================================================
# BACKUP DIRECTORY
# ==============================================================================
# Local directory to store backups
# Ensure this directory has sufficient disk space (minimum 50GB recommended)
BACKUP_DIR=/opt/euralis-gaveurs/backups

# For Windows:
# BACKUP_DIR=C:\EuralisGaveurs\backups

# ==============================================================================
# BACKUP OPTIONS
# ==============================================================================
# Enable compression (recommended)
ENABLE_COMPRESSION=true

# Enable encryption (highly recommended for production)
# Backups will be encrypted with AES256
ENABLE_ENCRYPTION=true

# Encryption password (REQUIRED if ENABLE_ENCRYPTION=true)
# Use a strong password and store it securely!
# Generate with: openssl rand -base64 32
ENCRYPTION_PASSWORD=your-very-strong-encryption-password-here

# ==============================================================================
# AWS S3 CONFIGURATION
# ==============================================================================
# Enable S3 upload for offsite backup storage
ENABLE_S3_UPLOAD=true

# S3 bucket name (create this bucket first!)
S3_BUCKET=euralis-gaveurs-backups

# AWS region
S3_REGION=eu-west-1

# AWS credentials
# RECOMMENDED: Use IAM role instead of access keys when running on EC2
# Or use AWS CLI credentials file: ~/.aws/credentials
AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

# S3 storage class (options: STANDARD, STANDARD_IA, GLACIER, DEEP_ARCHIVE)
S3_STORAGE_CLASS=STANDARD_IA

# ==============================================================================
# AZURE BLOB STORAGE CONFIGURATION
# ==============================================================================
# Enable Azure Blob Storage upload
ENABLE_AZURE_UPLOAD=false

# Azure storage account name
AZURE_STORAGE_ACCOUNT=eualalisgaveurs

# Azure storage account key
# Get from: Azure Portal > Storage Account > Access Keys
AZURE_STORAGE_KEY=your-azure-storage-account-key-here

# Azure container name (create this container first!)
AZURE_CONTAINER=gaveurs-backups

# Azure blob tier (Hot, Cool, Archive)
AZURE_BLOB_TIER=Cool

# ==============================================================================
# GOOGLE CLOUD STORAGE CONFIGURATION
# ==============================================================================
# Enable Google Cloud Storage upload
ENABLE_GCS_UPLOAD=false

# GCS bucket name
GCS_BUCKET=euralis-gaveurs-backups

# GCS credentials file path
# Create service account in GCP and download JSON key
GCS_CREDENTIALS_FILE=/path/to/gcs-service-account.json

# GCS storage class (STANDARD, NEARLINE, COLDLINE, ARCHIVE)
GCS_STORAGE_CLASS=NEARLINE

# ==============================================================================
# RETENTION POLICY
# ==============================================================================
# How many daily backups to keep
RETAIN_DAILY=7

# How many weekly backups to keep (Sunday backups)
RETAIN_WEEKLY=4

# How many monthly backups to keep (First day of month)
RETAIN_MONTHLY=12

# How many yearly backups to keep (January 1st)
RETAIN_YEARLY=3

# ==============================================================================
# EMAIL NOTIFICATION
# ==============================================================================
# Enable email notifications for backup status
ENABLE_EMAIL=true

# Recipient email address
EMAIL_TO=admin@euralis-gaveurs.com

# Sender email address
EMAIL_FROM=backup@euralis-gaveurs.com

# SMTP server configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# Use TLS (true/false)
SMTP_TLS=true

# Send email only on failures (true) or always (false)
EMAIL_ON_FAILURE_ONLY=false

# ==============================================================================
# SLACK NOTIFICATION
# ==============================================================================
# Enable Slack notifications
ENABLE_SLACK=true

# Slack webhook URL
# Create incoming webhook: https://api.slack.com/messaging/webhooks
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Slack channel (optional, override webhook default)
SLACK_CHANNEL=#backups

# Send notification only on failures
SLACK_ON_FAILURE_ONLY=false

# ==============================================================================
# DISCORD NOTIFICATION
# ==============================================================================
# Enable Discord notifications
ENABLE_DISCORD=false

# Discord webhook URL
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR/WEBHOOK/URL

# ==============================================================================
# MICROSOFT TEAMS NOTIFICATION
# ==============================================================================
# Enable Microsoft Teams notifications
ENABLE_TEAMS=false

# Teams webhook URL
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/YOUR/WEBHOOK/URL

# ==============================================================================
# ADVANCED OPTIONS
# ==============================================================================
# Backup verification (run integrity checks after backup)
ENABLE_VERIFICATION=true

# Parallel compression threads (0 = auto-detect CPU cores)
COMPRESSION_THREADS=0

# Enable point-in-time recovery (WAL archiving)
# Requires PostgreSQL WAL archiving to be configured
ENABLE_PITR=false
WAL_ARCHIVE_DIR=/var/lib/postgresql/wal_archive

# Backup specific tables only (comma-separated)
# Leave empty to backup entire database
BACKUP_TABLES_ONLY=

# Exclude specific tables from backup (comma-separated)
EXCLUDE_TABLES=temp_data,session_logs

# Custom pg_dump options
# Example: --exclude-table-data=large_table
PG_DUMP_OPTIONS=

# Backup timeout (seconds)
BACKUP_TIMEOUT=3600

# ==============================================================================
# MONITORING & ALERTING
# ==============================================================================
# Enable backup monitoring with external service
ENABLE_MONITORING=false

# Healthchecks.io integration
# https://healthchecks.io - Create a check and paste the URL here
HEALTHCHECK_URL=https://hc-ping.com/your-unique-uuid

# Prometheus Pushgateway
PROMETHEUS_PUSHGATEWAY=http://localhost:9091

# ==============================================================================
# LOGGING
# ==============================================================================
# Log level (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# Keep backup logs for N days
LOG_RETENTION_DAYS=30

# Send logs to syslog
ENABLE_SYSLOG=false
SYSLOG_SERVER=localhost
SYSLOG_PORT=514

# ==============================================================================
# SECURITY
# ==============================================================================
# File permissions for backups (Unix octal notation)
BACKUP_FILE_PERMISSIONS=0600

# Backup file ownership (user:group)
BACKUP_FILE_OWNER=postgres:postgres

# Enable secure deletion (overwrite files before deleting)
SECURE_DELETE=false

# ==============================================================================
# PERFORMANCE TUNING
# ==============================================================================
# PostgreSQL dump format (plain, custom, directory, tar)
# plain = SQL text, custom = pg_restore compatible, directory = parallel
PG_DUMP_FORMAT=plain

# Number of parallel dump jobs (directory format only)
PG_DUMP_JOBS=4

# Bandwidth limit for cloud uploads (KB/s, 0 = unlimited)
UPLOAD_BANDWIDTH_LIMIT=0

# ==============================================================================
# DISASTER RECOVERY
# ==============================================================================
# Enable backup to secondary location
ENABLE_SECONDARY_BACKUP=false
SECONDARY_BACKUP_DIR=/mnt/backup-nas/euralis-gaveurs

# Enable backup replication to remote server
ENABLE_REMOTE_BACKUP=false
REMOTE_BACKUP_HOST=backup-server.example.com
REMOTE_BACKUP_USER=backup-user
REMOTE_BACKUP_PATH=/backups/euralis-gaveurs

# Use rsync for remote backup
REMOTE_BACKUP_METHOD=rsync  # Options: rsync, scp, sftp

# ==============================================================================
# CUSTOM HOOKS
# ==============================================================================
# Script to run before backup starts
PRE_BACKUP_HOOK=

# Script to run after backup completes successfully
POST_BACKUP_HOOK=

# Script to run if backup fails
ON_FAILURE_HOOK=

# Example hooks:
# PRE_BACKUP_HOOK=/opt/scripts/stop-application.sh
# POST_BACKUP_HOOK=/opt/scripts/start-application.sh
# ON_FAILURE_HOOK=/opt/scripts/alert-admin.sh

# ==============================================================================
# NOTES
# ==============================================================================
# 1. Ensure PostgreSQL client tools (pg_dump, psql) are installed
# 2. Test backup/restore in development environment first
# 3. Verify cloud storage credentials before enabling
# 4. Monitor backup sizes to ensure sufficient storage
# 5. Regularly test restore procedures
# 6. Keep multiple backup copies in different locations
# 7. Protect this configuration file (chmod 600 backup-config.env)
#
# For production deployment:
# - Use strong encryption passwords
# - Enable cloud storage for offsite backups
# - Configure email/Slack notifications
# - Set up automated backup scheduling (cron)
# - Implement monitoring and alerting
# - Document restore procedures
# - Test disaster recovery plan
# ==============================================================================
